I will not document this function since it is very self documenting and is nested in another function.
